---
sidebar_position: 3
sidebar_label: App splitting
---

# Разбиение приложения

## Group: `Layers`

Первый уровень разделения: по **скоупу влияния** модуля

:::note Самопроверка

"К какому слою приложения относится модуль?"

:::

```sh
└── src/
    ├── app/                    # Инициализирующая логика приложения
    ├── processes/              # (Опц.) Процессы приложения, протекающие над страницами
    ├── pages/                  # Страницы приложения
    ├── features/               # Ключевая функциональность приложения
    ├── entities/               # Бизнес-сущности
    └── shared/                 # Переиспользуемые модули
```

### Порядок слоев

Если посмотреть на порядок слоев - то можно выделить две закономерности:

#### По уровню знания/ответственности

`app` > `processes` > `pages` > `features` > `entities` > `shared`

Модуль "знает" только про себя и нижележащие модули, но не выше лежащие

*Это же влияет и на разрешенные импорты*

#### По уровню опасности изменений

`shared` > `entities` > `features` > `pages` > `processes` > `app`

Чем ниже расположен модуль - тем опаснее вносить в него изменения

*Т.к. скорее всего он заиспользован во многих вышележащих слоях*

## Group: `Slices`

Второй уровень разделения: по **конкретной функциональности БЛ**

*Методология не влияет на этот уровень и все крайне зависит [от конкретного проекта][disc-usability]*

:::note Самопроверка

"Какую область БЛ затрагивает модуль?"

*До этого - надо определится со скоупом влияния (layer)*

:::

```sh
├── app/
|   # Не имеет конкретных слайсов, 
|   # Т.к. там содержится мета-логика над проектом и его инициализации
├── processes/
|   # Слайсы для реализации процессов на страницах
|   ├── payment
|   ├── auth
|   ├── quick-tour
|   └── ...
├── pages/
|   # Слайсы для реализации страниц приложения
|   # При этом, в силу специфики роутинга - могут вкладываться друг в друга
|   ├── profile
|   ├── sign-up
|   ├── feed
|   └── ...
├── features/
|   # Слайсы для реализации конкретной функциональности на страницах
|   ├── auth-by-phone
|   ├── inline-post
|   └── ...
├── entities/
|   # Слайсы бизнес-сущностей для реализации более сложной БЛ
|   ├── viewer
|   ├── posts
|   ├── i18n
|   └── ...
├── shared/
|    # Не имеет конкретных слайсов
|    # Представляет собой скорее набор общеиспользуемых сегментов, без привязки к БЛ
```

## Group: `Segments`

Третий уровень разделения: по **назначению модуля в коде и реализации**

:::note Самопроверка

"Какую часть тех. реализации логики затрагивает модуль?"

*До этого - надо определится со скоупом влияния (слой) и доменной принадлежностью (слайсом)*

:::

```sh
{layer}/
    ├── {slice}/
    |   ├── ui/                     # UI-логика (components, ui-widgets, ...)
    |   ├── model/                  # Бизнес-логика (store, actions, effects, reducers, ...)
    |   ├── lib/                    # Инфраструктурная логика (utils/helpers)
    |   ├── config*/                # Конфигурация (проекта / слайса)
    |   └── api*/                   # Логика запросов к API (api instances, requests, ...)
```

*При этом, каждый сегмент может быть представлен **как в виде файла, так и в виде отдельной директории** - в зависимости от сложности и размеров*

### Ограничения

Методология разрабатывалась с целью - не ограничивать и не утруждать разработчиков правилами выбора абстракций *(хотелось, чтобы **любой из сегментов можно было использовать в любом слое**)*

Однако в результате [дискуссий и анализа обширного опыта][disc-list] - было определено, что лучше и практичнее **ограничить каждый слой на используемые внутри сегменты**.

#### Общие правила

1. Чем **выше расположен** слой - тем больше он знает про БЛ приложения и наоборот
2. API логику [рекомендуется][disc-api] класть в `shared`, чтобы логика не распылялась по проекту
    - Как правило - она общая и представлена в виде единых инстансов
    - *Edge-case "exceptions"*: *GraphQL*, *react-query hooks*

#### Применение для слоев

| Слой      	| Содержимое                                                                                      	| Разрешенные сегменты                                                                                                                                                      	|
|-----------	|-----------------------------------------------------------------------------------------------	|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------	|
| **app**       	| Не включает в себя слайсы и содержит логику инициализации                                     	| Имеющиеся сегменты не совсем подходят, а потому используются обычно `/providers` (`/hoc`, ...), `/styles` и т.д. Очень зависит от проекта и вряд ли решается методологией 	|
| **processes** 	| Слайсы внутри включают в себя только бизнес-логику, без отображения (1)                       	| `lib` `model` (`api`)                                                                                                                                                     	|
| **pages**     	| Слайсы внутри включают в себя ui- и model- композицию различных фичей для конкретной страницы 	| `ui` `lib` `model` (`api`)                                                                                                                                            	|
| **features**  	| Слайсы внутри включают в себя композицию сущностей и реализацию БЛ в модели + отображение     	| `ui` `lib` `model` (`api`)                                                                                                                                            	|
| **entities**  	| Слайсы внутри представляют разрозненный набор подмодулей для использования                    	| `ui` `lib` `model` (`api`)                                                                                                                                            	|
| **shared**    	| Содержит только инфраструктурную логику без БЛ (1)                                            	| `ui` `lib` `api`                                                                                                                                                        	|

## См. также

- [(Обсуждение) Абстракции методологии, их цели и нейминг][disc-src]
- Обсуждения по неймингу сущностей
  - [Опрос по неймингу][disc-poll]
  - [`processes` vs `flows` vs ...][disc-processes]
  - [`model` vs `store` vs ...][disc-model]
- [Первичное описание абстракций][tg-description]
- [(Статья) Про организацию кодовой базы *с полным сравнением нескольких подходов*][ext-pluralsight]
- [(Статья) Про модуляризацию проектов][ext-medium]
- [(Reference) Layers][ref-layers]
- [(Reference) Segments][ref-segments]

[ref-layers]: /docs/reference/layers
[ref-segments]: /docs/reference/segments

[disc-src]: https://github.com/feature-sliced/documentation/discussions/31

[disc-list]: https://github.com/feature-sliced/documentation/discussions/
[disc-poll]: https://github.com/feature-sliced/documentation/discussions/31#discussioncomment-464894
[disc-api]: https://github.com/feature-sliced/documentation/discussions/66
[disc-processes]: https://github.com/feature-sliced/documentation/discussions/20
[disc-model]: https://github.com/feature-sliced/documentation/discussions/68
[disc-usability]: https://github.com/feature-sliced/documentation/discussions/65

[tg-description]: https://t.me/atomicdesign/18951

[ext-pluralsight]: https://www.pluralsight.com/guides/how-to-organize-your-react-+-redux-codebase
[ext-medium]: https://alexmngn.medium.com/why-react-developers-should-modularize-their-applications-d26d381854c1
