# Миграция с v1

> Миграция с feature-slices (v1)

---

[ext-v1]: https://github.com/feature-sliced/featureslices.dev/blob/master/v1.0.md
[ext-tg-spb]: https://t.me/feature_slices
[ext-fdd]: https://github.com/feature-sliced/wiki/tree/rc/feature-driven
[ext-v2]: https://github.com/feature-sliced/wiki
[ext-about]: ../about/readme.md
[ext-kof]: https://github.com/kof
[ext-kof-fdd]: https://www.youtube.com/watch?v=BWAeYuWFHhs

## Зачем `v2`?

> Опционально к прочтению

Изначальная концепция `feature-slices` [была заявлена][ext-tg-spb] еще в 2018 году.

С тех пор прошло много трансформаций методологии, но при этом [сохранялись базовые принципы][ext-v1]:
- Стандартизация структуры фронтенд-проектов
- Разбиение приложения согласно бизнес-логике
- Изолированные фичи, для предотвращения неявных сайд-эффектов и циклических зависимостей
- Использование `Public API ` с запретом лезть "в кишки" модуля

При этом, в прежней версии методологии все равно оставались *слабые места*, которые 
- Где-то приводили к бойлерплейту
- Где-то к чрезмерному усложнению проекта и онбординга новых людей
- Где-то к неявным правилам между абстракциями, которые были расположены на специфичных и не очень интуитивно понятных местах

Новая версия методологии ([v2][ext-v2]) призвана устранить эти недостатки, при этом сохраняя предыдущие достоинства подхода.

С 2018 года развивалась и другая подобная методология - [`feature-driven`][ext-fdd], о котором заявил впервые [Oleg Isonen][ext-kof].

По итогу слияния двух подходов, были улучшены и адаптированы имеющиеся подходы - в сторону большей понятности и практической пользы.

> Все это по итогу повлияло даже на наименование методологии - *"feature-slice**d**"*

## Changelog


### `BREAKING` shared

Инфраструктурные абстракции `/ui`, `/lib`, `/api`, которые раньше лежали в src-корне проекта, теперь обособлены отдельной директорией `/src/shared`

- `shared/ui` - Все так же общий uikit приложения (опционален)
    - *При этом никто не запрещает использовать здесь `Atomic Design` как раньше*
- `shared/lib` - Набор вспомогательных библиотек для реализации логики
    - *По-прежнему - без свалки хелперов*
- `shared/api` - Общий энтрипоинт для обращения к API
    - *Может прописываться и локально в каждой фиче/странице - но не рекомендуется*
- При этом явно, как и раньше - в `shared` не должно быть явной привязки к бизнес-логике
    - *При необходимости - нужно выносить эту связь на уровень `entities`*

### `BREAKING` layers

Теперь методология предполагает явное выделение слоев на верхнем уровне

- `/app` > `/processes` > **`/pages`** > **`/features`** > `/entities` > `/shared`
- *Т.е. не все теперь трактуется как фичи/страницы*
- Такой подход позволяет явно задать правила для слоев:
    - Чем **выше расположен слой** модуля - тем большим **контекстом** он располагает
        
        *(иными словами - каждый модуль слоя - может импортировать только **модули нижележащих слоев**, но не выше)*
    - Чем **ниже расположен слой** модуля - тем больше **опасности и ответственности** вносить в него изменения
        *(потому что, как правило - более переиспользуемыми являются именно нижележащие слои)*

### `BREAKING` naming

Теперь 
- директорию `/components` рекомендуется называть `/ui` *(ui-сегмент)*
- директорию `/store` *(у кого так было)* рекомендуется называть `/model` *(БЛ-сегмент)*


### `NEW` abstractions

В v2 **добавлены новые сущности**, для резолвинга проблем сильной связности и усложнения логики

- `/entities` - слой **бизнес-сущностей**, содержащий в себе слайсы, относящиеся напрямую к бизнес-моделям или синтетическим сущностям, необходимым только на фронтенде
    - Примеры слайсов: `user`, `i18n`, `order`
- `/processes` - слой **бизнес-процессов**, пронизывающих приложение
    - Примеры слайсов: `payment`, `auth`, `quick-tour`

## См. также
- [Заметки с доклада "React SPB Meetup #1"][ext-tg-spb]
- [React Berlin Talk - Oleg Isonen "Feature Driven Architecture"][ext-kof-fdd]
- [Сравнение с v1 (community-chat)](https://t.me/feature_sliced/493)
- [Новые идеи v2 с пояснениями (atomicdesign-chat)](https://t.me/atomicdesign/18708)
